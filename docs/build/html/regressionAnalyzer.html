
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

    <title>Welcome to the documentation of metabolic objective analysis &#8212; SCOOTI 0.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Welcome to the documentation of metabolic objective analysis" href="metObjAnalyzer.html" />
    <link rel="prev" title="Welcome to SCOOTI’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="welcome-to-the-documentation-of-metabolic-objective-analysis">
<h1>Welcome to the documentation of metabolic objective analysis<a class="headerlink" href="#welcome-to-the-documentation-of-metabolic-objective-analysis" title="Permalink to this heading">¶</a></h1>
<section id="module-SCOOTI.regressionAnalyzer">
<span id="core-analysis-module"></span><h2>Core Analysis Module<a class="headerlink" href="#module-SCOOTI.regressionAnalyzer" title="Permalink to this heading">¶</a></h2>
<section id="regressionanalyzer-py">
<h3>regressionAnalyzer.py<a class="headerlink" href="#regressionanalyzer-py" title="Permalink to this heading">¶</a></h3>
<p>A collection of methods for analysis of metabolic objectives and flux predictions</p>
</section>
<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.CVscore_plot">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">CVscore_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.CVscore_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>The allocation of each metabolite in objectives that are shown with overlapped barplots.</p>
<p>The allocation of coefficients will be represented by
c/Sigma(c) if norm is set true</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef_df</strong> (<em>{pandas.DataFrame}</em><em> of </em><em>shape</em><em> (</em><em>n_metabolites</em><em>, </em><em>n_samples</em><em>)</em><em>,</em>) – the coefficients of metabolic objectives for each samples</p></li>
<li><p><strong>labels</strong> (<em>{array-like}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em><em>,</em>) – the labels of samples/columns</p></li>
<li><p><strong>cellType</strong> (<em>{string}</em><em>,</em>) – the label used as a reference</p></li>
<li><p><strong>prefix</strong> (<em>{string}</em><em>, </em><em>default=''</em>) – experiment names for saving files</p></li>
<li><p><strong>norm</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – normalize coefficients by the sum of all the coefficients</p></li>
<li><p><strong>cutoff</strong> (<em>{float}</em><em>, </em><em>default=0.0</em>) – thresholds to show the allocation/coefficients of metabolites</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.EXflux_validation">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">EXflux_validation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match_map_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffm_cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiObj_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncon_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overall_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.EXflux_validation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> (<em>multiObj_df</em>) – </p></li>
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>bool</strong><strong>)</strong> (<em>col_replace</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>(dictionary)</em></p></li>
<li><p><em>{</em></p></li>
<li><p><strong>‘correlation’</strong> (<em>valid_corr_df (pandas.DataFrame)</em>)</p></li>
<li><p><strong>’predicted_fluxes’</strong> (<em>flux_valid (pandas.DataFrame)</em>)</p></li>
<li><p><strong>’stacking_correlation’</strong> (<em>corr_all (float)</em>)</p></li>
<li><p><strong>’pvalues’</strong> (<em>pvs (numpy.array)</em>)</p></li>
<li><p><strong>’coefficients’</strong> (<em>coefs (numpy.array)</em>)</p></li>
<li><p><strong>’CI_lb’</strong> (<em>CI_lb (numpy.array)</em>)</p></li>
<li><p><strong>’CI_ub’</strong> (<em>CI_ub (numpy.array)</em>)</p></li>
<li><p><em>}</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.GESA_analyais">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">GESA_analyais</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pc_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reclusters</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exptb</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gesa_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'trophectoderm'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellTypes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['1C2C',</span> <span class="pre">'2CBC']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheetnames</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">['2C',</span> <span class="pre">'BC']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">reduction_func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UMAP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pluri_gene_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/daweilin/StemCell/Project_mESC_JinZhang/mcdb/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigGenes_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/nfs/turbo/umms-csriram/daweilin/data/scEmbryo/GSE136714/old_sigGenes/'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/daweilin/StemCell/Project_mESC_JinZhang/regressor_results_new/'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.GESA_analyais" title="Permalink to this definition">¶</a></dt>
<dd><section id="description">
<h3>Description<a class="headerlink" href="#description" title="Permalink to this heading">¶</a></h3>
<p>1. Determine if significant genes in each data point can be categoried into
a certain GESA function by hypergeometic tests aka functional analysis
2. Dimension reudction plots overlaies p-values of functional analysis
3. Compare p-values in clusters (reclustered by HDBSCAN)</p>
<dl class="field-list simple">
<dt class="field-odd">param pc_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type pc_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-even"><p>dimension reduction results</p>
</dd>
<dt class="field-odd">param reclusters (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type reclusters (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-even"><p>reclusters of dimension reduction results</p>
</dd>
<dt class="field-odd">param label_col (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type label_col (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>column name to access a list of names corresponding to the pc data</p>
</dd>
<dt class="field-odd">param exptb (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type exptb (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-even"><p>gene expression data</p>
</dd>
<dt class="field-odd">param gesa_name (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type gesa_name (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>folder name of the data (embryoDevelopment/pluripotency/proliferation)</p>
</dd>
<dt class="field-odd">param cellTypes (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type cellTypes (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of names to access the folders that save significant gene data</p>
</dd>
<dt class="field-odd">param sheetnames (list)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type sheetnames (list)<span class="colon">:</span></dt>
<dd class="field-even"><p>a list of names to access the excel sheets/csv that save sig genes</p>
</dd>
<dt class="field-odd">param reduction_func (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type reduction_func (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the function of reduction methods used to access columns</p>
</dd>
<dt class="field-odd">param sigGenes_root_path (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type sigGenes_root_path (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access the significant genes</p>
</dd>
<dt class="field-odd">param save_root_path (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type save_root_path (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to save figures</p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.Objflux_validation">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">Objflux_validation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">match_map_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ffm_cp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">multiObj_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_replace</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overall_correlation</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.Objflux_validation" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> (<em>multiObj_df</em>) – </p></li>
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>bool</strong><strong>)</strong> (<em>col_replace</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>(dictionary)</em></p></li>
<li><p><em>{</em></p></li>
<li><p><strong>‘correlation’</strong> (<em>valid_corr_df (pandas.DataFrame)</em>)</p></li>
<li><p><strong>’predicted_fluxes’</strong> (<em>flux_valid (pandas.DataFrame)</em>)</p></li>
<li><p><strong>’stacking_correlation’</strong> (<em>corr_all (float)</em>)</p></li>
<li><p><strong>’pvalues’</strong> (<em>pvs (numpy.array)</em>)</p></li>
<li><p><strong>’coefficients’</strong> (<em>coefs (numpy.array)</em>)</p></li>
<li><p><strong>’CI_lb’</strong> (<em>CI_lb (numpy.array)</em>)</p></li>
<li><p><strong>’CI_ub’</strong> (<em>CI_ub (numpy.array)</em>)</p></li>
<li><p><em>}</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.allocation_plot">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">allocation_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cellType</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.allocation_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>The allocation of each metabolite in inferred metabolic objectives.</p>
<p>The allocation of coefficients will be represented by
c/Sigma(c) if norm is set true</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef_df</strong> (<em>{pandas.DataFrame}</em><em> of </em><em>shape</em><em> (</em><em>n_metabolites</em><em>, </em><em>n_samples</em><em>)</em><em>,</em>) – the coefficients of metabolic objectives for each samples</p></li>
<li><p><strong>labels</strong> (<em>{array-like}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em><em>,</em>) – the labels of samples/columns</p></li>
<li><p><strong>cellType</strong> (<em>{string}</em><em>,</em>) – the label selected to show allocations</p></li>
<li><p><strong>prefix</strong> (<em>{string}</em><em>, </em><em>default=''</em>) – experiment names for saving files</p></li>
<li><p><strong>norm</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – normalize coefficients by the sum of all the coefficients</p></li>
<li><p><strong>cutoff</strong> (<em>{float}</em><em>, </em><em>default=0.0</em>) – thresholds to show the allocation/coefficients of metabolites</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.archetypal_computing">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">archetypal_computing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arch</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">6</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">select_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_other</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_arch_scan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">simplex_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">archetype_profile_plot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.archetypal_computing" title="Permalink to this definition">¶</a></dt>
<dd><p>Using archetypal computing to extract extreme features</p>
<p>This function is adapted from the archetypal analysis code applying RSS method
We integrate the function to our pipeline and data format
Motevalli Soumehsaraei A Benyamin; Barnard. Archetypal Analysis Package. v1. CSIRO. Software Collection.; 2019.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>n_arch</strong> (<em>{integer}</em><em>, </em><em>default=6</em>) – number of archetypes</p></li>
<li><p><strong>select_labels</strong> (<em>{list-like}</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – a list of labels/samples that are chosen to show up (rest of samples will be labeled as “other”)</p></li>
<li><p><strong>show_other</strong> (<em>{bool}</em><em>, </em><em>default=0</em>) – Set True to show samples labeled by “other” or not.</p></li>
<li><p><strong>prefix</strong> (<em>{string}</em><em>, </em><em>default=''</em>) – name of an experiment or anything worth to add into the file names</p></li>
<li><p><strong>n_arch_scan</strong> (<em>{bool}</em><em>, </em><em>default=False</em>) – scan number of archetypes that affects the explained variances</p></li>
<li><p><strong>simplex_plot</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – enable plotting similarities among data points and archetypes</p></li>
<li><p><strong>archetype_profile_plot</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – enable plottting profiles of archetypes with heatmaps</p></li>
<li><p><strong>norm</strong> (<em>{bool}</em><em>, </em><em>default=False</em>) – normalize the input data and sum to 1 which is equal to allocation</p></li>
<li><p><strong>save_root_path</strong> (<em>{string}</em><em>, </em><em>default='./'</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>AA</strong> – Object of archetypal analysis</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{python class},</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.biomass_gene_essentiality">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">biomass_gene_essentiality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ko_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_para</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">paras</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biomass_reaction_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'BIOMASS_maintenance'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zscore'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Recon3D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geneID_symbol_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/nfs/turbo/umms-csriram/daweilin/data/BiGG/Recon3D_genes.json'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.biomass_gene_essentiality" title="Permalink to this definition">¶</a></dt>
<dd><section id="id1">
<h3>Description<a class="headerlink" href="#id1" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>Calculate the changes of biomass objective values with different KO</p></li>
<li><p>Identify genes resulting in significantly changes with diff criteria</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">param ko_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type ko_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-even"><p>data table–&gt;genes–&gt;columns and rxns–&gt;rows</p>
</dd>
<dt class="field-odd">param sel_para<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param method (str)<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">type method (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p>the criteria used to identify genes</p>
</dd>
<dt class="field-even">param - ‘zscore’<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">type - ‘zscore’<span class="colon">:</span></dt>
<dd class="field-odd"><p>default, standarize data and find genes with provided thresholds</p>
</dd>
<dt class="field-even">param - ‘percentage’<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">type - ‘percentage’<span class="colon">:</span></dt>
<dd class="field-odd"><p>gene is essential if KO biomass&lt;N% WT biomass (Yang et al., 2014)</p>
</dd>
<dt class="field-even">param th (float)<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">type th (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p>thresholds for identifying genes, num of std/percentage for zscore/percentage</p>
</dd>
<dt class="field-even">returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>sigGenes (list)</strong></p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>a list of significant genes</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.boxplot_fig">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">boxplot_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mets_category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.05</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col3</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plottype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'boxplot'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">xlabel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Normalized</span> <span class="pre">coefficients'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_ub</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.boxplot_fig" title="Permalink to this definition">¶</a></dt>
<dd><section id="id2">
<h3>Description<a class="headerlink" href="#id2" title="Permalink to this heading">¶</a></h3>
<ul class="simple">
<li><p>Identifies significant metabolites among up to three different samples</p></li>
<li><p>Calculates based on p-values and fold changes</p></li>
<li><p>Generates figures</p></li>
</ul>
<dl class="field-list simple">
<dt class="field-odd">param input_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type input_df (pandas.DataFrame)<span class="colon">:</span></dt>
<dd class="field-even"><p>a table with metabolites as rows and cells as columns</p>
</dd>
<dt class="field-odd">param mets_category (dictionary)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type mets_category (dictionary)<span class="colon">:</span></dt>
<dd class="field-even"><p>a dict of metabolites with corresponding types</p>
</dd>
<dt class="field-odd">param labels (list/pandas.DataFrame/numpy.array)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type labels (list/pandas.DataFrame/numpy.array)<span class="colon">:</span></dt>
<dd class="field-even"><p>desired labels for columns</p>
</dd>
<dt class="field-odd">param col_str (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type col_str (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the reference column used to sort values</p>
</dd>
<dt class="field-odd">param col1 (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type col1 (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the first sample (e.g. control)</p>
</dd>
<dt class="field-odd">param col2 (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type col2 (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the second sample (e.g. experiment)</p>
</dd>
<dt class="field-odd">param prefix (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type prefix (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the experiment for saving figures</p>
</dd>
<dt class="field-odd">param Optional Arguments<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param ——————<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param value_ordering (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type value_ordering (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>sort values based on fold changes if set true</p>
</dd>
<dt class="field-odd">param pv (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type pv (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>p-value thresholds</p>
</dd>
<dt class="field-odd">param fc (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type fc (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>fold change thresholds</p>
</dd>
<dt class="field-odd">param col3 (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type col3 (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the third sample</p>
</dd>
<dt class="field-odd">param portion (float)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type portion (float)<span class="colon">:</span></dt>
<dd class="field-even"><p>the portion of cells selecting a metabolite</p>
</dd>
<dt class="field-odd">param norm (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type norm (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>scale values to the range between [0, 1] if set True</p>
</dd>
<dt class="field-odd">param plottype (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type plottype (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>boxplot or stripplot with mean values</p>
</dd>
<dt class="field-odd">param xlabels (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type xlabels (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>name of the label on the x-axis</p>
</dd>
<dt class="field-odd">param save_root_path (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type save_root_path (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to save the figure</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>coef_boxplot(dfs) (function)</strong></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>generate a figure and dataframe of calculations</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">clustering_func</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pca_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mets_category</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func" title="Permalink to this definition">¶</a></dt>
<dd><section id="parameter">
<h3>Parameter<a class="headerlink" href="#parameter" title="Permalink to this heading">¶</a></h3>
<p>pca_df (pandas dataframe): genes/reactions/objectives by cells/tissues IDs</p>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>res_df (pandas dataframe)</strong></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>pca_df with new columns that records entropy and clusters</p>
</dd>
</dl>
<dl class="py class">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">StandardScaler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_mean</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">with_std</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler" title="Permalink to this definition">¶</a></dt>
<dd><p>Standardize features by removing the mean and scaling to unit variance.</p>
<p>The standard score of a sample <cite>x</cite> is calculated as:</p>
<blockquote>
<div><p>z = (x - u) / s</p>
</div></blockquote>
<p>where <cite>u</cite> is the mean of the training samples or zero if <cite>with_mean=False</cite>,
and <cite>s</cite> is the standard deviation of the training samples or one if
<cite>with_std=False</cite>.</p>
<p>Centering and scaling happen independently on each feature by computing
the relevant statistics on the samples in the training set. Mean and
standard deviation are then stored to be used on later data using
<a class="reference internal" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.transform" title="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transform()</span></code></a>.</p>
<p>Standardization of a dataset is a common requirement for many
machine learning estimators: they might behave badly if the
individual features do not more or less look like standard normally
distributed data (e.g. Gaussian with 0 mean and unit variance).</p>
<p>For instance many elements used in the objective function of
a learning algorithm (such as the RBF kernel of Support Vector
Machines or the L1 and L2 regularizers of linear models) assume that
all features are centered around 0 and have variance in the same
order. If a feature has a variance that is orders of magnitude larger
that others, it might dominate the objective function and make the
estimator unable to learn from other features correctly as expected.</p>
<p>This scaler can also be applied to sparse CSR or CSC matrices by passing
<cite>with_mean=False</cite> to avoid breaking the sparsity structure of the data.</p>
<p>Read more in the <span class="xref std std-ref">User Guide</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If False, try to avoid a copy and do inplace scaling instead.
This is not guaranteed to always work inplace; e.g. if the data is
not a NumPy array or scipy.sparse CSR matrix, a copy may still be
returned.</p></li>
<li><p><strong>with_mean</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, center the data before scaling.
This does not work (and will raise an exception) when attempted on
sparse matrices, because centering them entails building a dense
matrix which in common use cases is likely to be too large to fit in
memory.</p></li>
<li><p><strong>with_std</strong> (<em>bool</em><em>, </em><em>default=True</em>) – If True, scale the data to unit variance (or equivalently,
unit standard deviation).</p></li>
</ul>
</dd>
</dl>
<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.scale_">
<span class="sig-name descname"><span class="pre">scale_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.scale_" title="Permalink to this definition">¶</a></dt>
<dd><p>Per feature relative scaling of the data to achieve zero mean and unit
variance. Generally this is calculated using <cite>np.sqrt(var_)</cite>. If a
variance is zero, we can’t achieve unit variance, and the data is left
as-is, giving a scaling factor of 1. <cite>scale_</cite> is equal to <cite>None</cite>
when <cite>with_std=False</cite>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.17: </span><em>scale_</em></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (n_features,) or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.mean_">
<span class="sig-name descname"><span class="pre">mean_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.mean_" title="Permalink to this definition">¶</a></dt>
<dd><p>The mean value for each feature in the training set.
Equal to <code class="docutils literal notranslate"><span class="pre">None</span></code> when <code class="docutils literal notranslate"><span class="pre">with_mean=False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (n_features,) or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.var_">
<span class="sig-name descname"><span class="pre">var_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.var_" title="Permalink to this definition">¶</a></dt>
<dd><p>The variance for each feature in the training set. Used to compute
<cite>scale_</cite>. Equal to <code class="docutils literal notranslate"><span class="pre">None</span></code> when <code class="docutils literal notranslate"><span class="pre">with_std=False</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (n_features,) or None</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.n_features_in_">
<span class="sig-name descname"><span class="pre">n_features_in_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.n_features_in_" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of features seen during <span class="xref std std-term">fit</span>.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.feature_names_in_">
<span class="sig-name descname"><span class="pre">feature_names_in_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.feature_names_in_" title="Permalink to this definition">¶</a></dt>
<dd><p>Names of features seen during <span class="xref std std-term">fit</span>. Defined only when <cite>X</cite>
has feature names that are all strings.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 1.0.</span></p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>ndarray of shape (<cite>n_features_in_</cite>,)</p>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.n_samples_seen_">
<span class="sig-name descname"><span class="pre">n_samples_seen_</span></span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.n_samples_seen_" title="Permalink to this definition">¶</a></dt>
<dd><p>The number of samples processed by the estimator for each feature.
If there are no missing samples, the <code class="docutils literal notranslate"><span class="pre">n_samples_seen</span></code> will be an
integer, otherwise it will be an array of dtype int. If
<cite>sample_weights</cite> are used it will be a float (if no missing data)
or an array of dtype float that sums the weights seen so far.
Will be reset on new calls to fit, but increments across
<code class="docutils literal notranslate"><span class="pre">partial_fit</span></code> calls.</p>
<dl class="field-list simple">
<dt class="field-odd">Type<span class="colon">:</span></dt>
<dd class="field-odd"><p>int or ndarray of shape (n_features,)</p>
</dd>
</dl>
</dd></dl>

<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></dt><dd><p>Equivalent function without the estimator API.</p>
</dd>
<dt><code class="xref py py-class docutils literal notranslate"><span class="pre">PCA</span></code></dt><dd><p>Further removes the linear correlation across features with ‘whiten=True’.</p>
</dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>NaNs are treated as missing values: disregarded in fit, and maintained in
transform.</p>
<p>We use a biased estimator for the standard deviation, equivalent to
<cite>numpy.std(x, ddof=0)</cite>. Note that the choice of <cite>ddof</cite> is unlikely to
affect model performance.</p>
<p>For a comparison of the different scalers, transformers, and normalizers,
see <span class="xref std std-ref">examples/preprocessing/plot_all_scaling.py</span>.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">sklearn.preprocessing</span> <span class="kn">import</span> <span class="n">StandardScaler</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="p">[[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scaler</span> <span class="o">=</span> <span class="n">StandardScaler</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="go">StandardScaler()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">mean_</span><span class="p">)</span>
<span class="go">[0.5 0.5]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><span class="n">data</span><span class="p">))</span>
<span class="go">[[-1. -1.]</span>
<span class="go"> [-1. -1.]</span>
<span class="go"> [ 1.  1.]</span>
<span class="go"> [ 1.  1.]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">scaler</span><span class="o">.</span><span class="n">transform</span><span class="p">([[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]))</span>
<span class="go">[[3. 3.]]</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.fit">
<span class="sig-name descname"><span class="pre">fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the mean and std to be used for later scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The data used to compute the mean and standard deviation
used for later scaling along the features axis.</p></li>
<li><p><strong>y</strong> (<em>None</em>) – Ignored.</p></li>
<li><p><strong>sample_weight</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em><em>, </em><em>default=None</em>) – <p>Individual weights for each sample.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24: </span>parameter <em>sample_weight</em> support to StandardScaler.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted scaler.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.inverse_transform">
<span class="sig-name descname"><span class="pre">inverse_transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.inverse_transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Scale back the data to the original representation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The data used to scale along the features axis.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>default=None</em>) – Copy the input X or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X_tr</strong> – Transformed array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{ndarray, sparse matrix} of shape (n_samples, n_features)</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.partial_fit">
<span class="sig-name descname"><span class="pre">partial_fit</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_weight</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.partial_fit" title="Permalink to this definition">¶</a></dt>
<dd><p>Online computation of mean and std on X for later scaling.</p>
<p>All of X is processed as a single batch. This is intended for cases
when <a class="reference internal" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.fit" title="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.fit"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit()</span></code></a> is not feasible due to very large number of
<cite>n_samples</cite> or because X is read from a continuous stream.</p>
<p>The algorithm for incremental mean and std is given in Equation 1.5a,b
in Chan, Tony F., Gene H. Golub, and Randall J. LeVeque. “Algorithms
for computing the sample variance: Analysis and recommendations.”
The American Statistician 37.3 (1983): 242-247:</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>{array-like</em><em>, </em><em>sparse matrix}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The data used to compute the mean and standard deviation
used for later scaling along the features axis.</p></li>
<li><p><strong>y</strong> (<em>None</em>) – Ignored.</p></li>
<li><p><strong>sample_weight</strong> (<em>array-like</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em><em>, </em><em>default=None</em>) – <p>Individual weights for each sample.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 0.24: </span>parameter <em>sample_weight</em> support to StandardScaler.</p>
</div>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>self</strong> – Fitted scaler.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>object</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.transform">
<span class="sig-name descname"><span class="pre">transform</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">copy</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.StandardScaler.transform" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform standardization by centering and scaling.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>X</strong> (<em>{array-like</em><em>, </em><em>sparse matrix</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>, </em><em>n_features</em><em>)</em>) – The data used to scale along the features axis.</p></li>
<li><p><strong>copy</strong> (<em>bool</em><em>, </em><em>default=None</em>) – Copy the input X or not.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>X_tr</strong> – Transformed array.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{ndarray, sparse matrix} of shape (n_samples, n_features)</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.clustering_func.reclustering">
<span class="sig-name descname"><span class="pre">reclustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">cluster_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'UMAP'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.clustering_func.reclustering" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> (<em>cluster_res</em>) – </p></li>
<li><p><strong>(</strong><strong>list</strong><strong>)</strong> (<em>cols</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>recluster_res (pandas.DataFrame)</strong></p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>data reclustering coming with the true/predicted labels.</p>
</dd>
</dl>
</dd></dl>

</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.coef_distance_to_biomassObj">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">coef_distance_to_biomassObj</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biomass_coef_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'euclidean'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">rank</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_input_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'model'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">histplot</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxplot_cols</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">boxplot_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.coef_distance_to_biomassObj" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize Eucleadian distances from inferred objectives to biomass objectives</p>
<p>Objective coefficients of up to three different samples will be compared to the coefficients
in the biomass objectives metabolites with Eucleadian distances and statistically tested with T-test.
Note that the coefficients of h2o is ignored by this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>{pandas.DataFrame}</em><em> of </em><em>shape</em><em> (</em><em>n_metabolites</em><em>, </em><em>n_samples</em><em>)</em>) – a table with metabolites as rows and cells as columns</p></li>
<li><p><strong>labels</strong> (<em>{list/pandas.DataFrame/numpy.array}</em><em>,</em>) – desired labels for columns</p></li>
<li><p><strong>biomass_coef_df</strong> (<em>{pandas.DataFrame}</em><em> of </em><em>shape</em><em> (</em><em>n_metabolites</em><em>, </em><em>1</em><em>)</em>) – table that saves coefficients of a biomass objective that could be from Recon1, Recon2.2, or Recon3D</p></li>
<li><p><strong>prefix</strong> (<em>{str}</em>) – name of the experiment for saving figures</p></li>
<li><p><strong>func</strong> (<em>{string}</em><em>, </em><em>default='euclidean'</em>) – name of the method used for the calculation of distances between coefficients</p></li>
<li><p><strong>norm</strong> (<em>{bool}</em><em>, </em><em>default=False</em>) – normalize the coefficient of each sample by the summation of coefficients of metabolites</p></li>
<li><p><strong>save_root_path</strong> (<em>{str}</em><em>, </em><em>default='./'</em>) – path to save the figure</p></li>
<li><p><strong>histplot</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – show histogram next to the scatterplot</p></li>
<li><p><strong>boxplot_cols</strong> (<em>{array-like}</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – [WARNING] this input has been deprecated. will be removed in the future</p></li>
<li><p><strong>boxplot_order</strong> (<em>{array-like}</em><em>, </em><em>default=</em><em>[</em><em>]</em>) – names of samples corresponding to labels that order the scatterplot from top to bottom</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.constrained_models">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">constrained_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_paraScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DFA_paraScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_fluxes.csv.gz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">input_path_pattern</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biomass_reaction_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'biomass_objective'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DFA_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.constrained_models" title="Permalink to this definition">¶</a></dt>
<dd><section id="id3">
<h3>Description<a class="headerlink" href="#id3" title="Permalink to this heading">¶</a></h3>
<p>Organize constrained modeling of fluxes without objectives</p>
<dl class="field-list simple">
<dt class="field-odd">param root_path (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type root_path (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access all the files</p>
</dd>
<dt class="field-odd">param CFR_paraScan (list of float)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type CFR_paraScan (list of float)<span class="colon">:</span></dt>
<dd class="field-even"><p>CFR parameters of interest used to output fluxes</p>
</dd>
<dt class="field-odd">param DFA_paraScan (list of float)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type DFA_paraScan (list of float)<span class="colon">:</span></dt>
<dd class="field-even"><p>DFA parameters of interest used to output fluxes</p>
</dd>
<dt class="field-odd">param randomScan (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type randomScan (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>read all models without considering parameters</p>
</dd>
<dt class="field-odd">param norm (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type norm (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if normalize the data by the summation of fluxes or not</p>
</dd>
<dt class="field-odd">param stack_model (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type stack_model (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>models with stacked constraints</p>
</dd>
<dt class="field-odd">param file_suffix (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type file_suffix (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>the suffix of filenames to read</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>res_df (pandas.DataFrame)</strong></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>reaction fluxes with parameters of interest</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.extracellular_flux_matching">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">extracellular_flux_matching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metabolome_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">uncon_res</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mets_category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MetCol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Extracellular</span> <span class="pre">Metabolites'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.extracellular_flux_matching" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>str</strong><strong>)</strong> (<em>sheet_name</em>) – </p></li>
<li><p><strong>(</strong><strong>str</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>pandas.DataFrame</strong><strong>)</strong> (<em>uncon_res</em>) – </p></li>
<li><p><strong>(</strong><strong>dictionary</strong><strong>)</strong> (<em>mets_category</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>match_map_df (pandas.DataFrame)</em></p></li>
<li><p><em>ffm_cp (pandas.DataFrame)</em></p></li>
<li><p><em>ffm_reg (pandas.DataFrame)</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.fva_constrained_models">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">fva_constrained_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.fva_constrained_models" title="Permalink to this definition">¶</a></dt>
<dd><p>Data loading: constrained modeling of HumanAtlas without objectives</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.geneID_symbol_map">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">geneID_symbol_map</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/nfs/turbo/umms-csriram/daweilin/data/BiGG/Recon3D_genes.json'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Recon3D'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.geneID_symbol_map" title="Permalink to this definition">¶</a></dt>
<dd><section id="id4">
<h3>Description<a class="headerlink" href="#id4" title="Permalink to this heading">¶</a></h3>
<p>Read .json files and organize the res into a dictionary with gene IDs as keys and gene symbols as values</p>
<dl class="field-list simple">
<dt class="field-odd">param path (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type path (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access the .json file which saved the gene IDs used in the models and corresponding symbols</p>
</dd>
<dt class="field-odd">param example paths<span class="colon">:</span></dt>
<dd class="field-odd"><p>Recon3D: ‘/nfs/turbo/umms-csriram/daweilin/data/BiGG/Recon3D_genes.json’
Recon2.2: ‘/nfs/turbo/umms-csriram/daweilin/data/BiGG/Recon2.2_symbol_to_hgnc.json’</p>
</dd>
<dt class="field-even">returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>geneMap (dict)</strong></p>
</dd>
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>dictionary saved the gene IDs used in the models and corresponding symbols</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.getRxnCoefficients">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">getRxnCoefficients</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/daweilin/StemCell/cancer_model.mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Recon1'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.getRxnCoefficients" title="Permalink to this definition">¶</a></dt>
<dd><p>Breakdown coefficients of biomass objectives from a given metabolic model</p>
<p>A biomass objective is a linear combination of multiple metabolites as reactants with non-negative coefficients.
Although there would be products produced by a biomass objective reaction, the function will ignore them.
The biomass objective could be from different metabolic models such as Recon1, Recon2.2, and Recon3D.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> (<em>{string}</em><em>, </em><em>default='/home/daweilin/StemCell/cancer_model.mat'</em>) – path to access a metabolic model</p></li>
<li><p><strong>model_name</strong> (<em>{string}</em><em>, </em><em>default='Recon1'</em>) – name of the metabolic model</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>biomass_coef_df</strong> – table that saves metabolites in rows and corresponding coefficients in the first column</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{pandas.DataFrame} of shape (n_metabolites, 1)</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.get_MSigDB">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">get_MSigDB</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dbName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'2023.1.Hs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categoryName</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'h.all'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_db</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">list_category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_to_csv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">flip</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.get_MSigDB" title="Permalink to this definition">¶</a></dt>
<dd><p>Access to significant genes collected in MSigDB database</p>
<p>This function relies on the GESApy package to access MSigDB and retrieve
certain categories of significant genes from an assigned database.
The releases of the data are from
<a class="reference external" href="https://data.broadinstitute.org/gsea-msigdb/msigdb/release/">https://data.broadinstitute.org/gsea-msigdb/msigdb/release/</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dbName</strong> (<em>{string}</em><em>, </em><em>default=&quot;2023.1.Hs&quot;</em>) – Name of MSigDB database. Please check the url provided above.
(Hs=Human, Mm=mouse)</p></li>
<li><p><strong>categoryName</strong> (<em>{string}</em><em>, </em><em>default='h.all'</em>) – Name of categories of significant genes.</p></li>
<li><p><strong>list_db</strong> (<em>{bool}</em><em>, </em><em>default=False</em>) – helper function to check out all the databases</p></li>
<li><p><strong>list_category</strong> (<em>{bool}</em><em>, </em><em>default=False</em>) – helper function to check out all the categories in a given database</p></li>
<li><p><strong>save_to_csv</strong> (<em>{string}</em><em>, </em><em>default=''</em>) – if the parameter is not empty, the significant genes will be saved in
.csv files with filenames that are name of gene sets.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>gmt</strong> – Name of gene sets and corresponding significant genes</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{dictionary}, optional</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.hypergeom_test">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">hypergeom_test</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">N</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">k</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.hypergeom_test" title="Permalink to this definition">¶</a></dt>
<dd><p>arr1: array with only 1, 0, -1
arr2: array with only 1, 0, -1</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.load_multiObj_models">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">load_multiObj_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'KSOM'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_paraScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DFA_paraScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">randomScan</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">topology_use</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stack_model</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_suffix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'_fluxes.csv.gz'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ind_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biomass_reaction_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'biomass_objective'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CFR_r</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">DFA_k</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[10,</span> <span class="pre">1,</span> <span class="pre">0.1,</span> <span class="pre">0.01,</span> <span class="pre">0.001]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.load_multiObj_models" title="Permalink to this definition">¶</a></dt>
<dd><section id="id5">
<h3>Description<a class="headerlink" href="#id5" title="Permalink to this heading">¶</a></h3>
<p>Organize any types of models</p>
<dl class="field-list simple">
<dt class="field-odd">param root_path (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type root_path (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access all the files</p>
</dd>
<dt class="field-odd">param medium (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type medium (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>medium used for input metabolites e.g. DMEMF12 or KSOM</p>
</dd>
<dt class="field-odd">param return_variables (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type return_variables (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>True for return fluxes or False for objective values</p>
</dd>
<dt class="field-odd">param norm (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type norm (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if normalize the data by the summation of fluxes or not</p>
</dd>
<dt class="field-odd">param CFR_paraScan (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type CFR_paraScan (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if filtering models with CFR parameters of interest</p>
</dd>
<dt class="field-odd">param DFA_paraScan (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type DFA_paraScan (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if filtering models with DFA parameters of interest</p>
</dd>
<dt class="field-odd">param randomScan (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type randomScan (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>read all models without considering parameters</p>
</dd>
<dt class="field-odd">param topology_use (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type topology_use (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>remove fluxes of candidate metabolites but biomass objective</p>
</dd>
<dt class="field-odd">param stack_model (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type stack_model (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>models with stacked constraints</p>
</dd>
<dt class="field-odd">param CFR_k (list of floats)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type CFR_k (list of floats)<span class="colon">:</span></dt>
<dd class="field-even"><p>CFR kappa of interest used to output fluxes</p>
</dd>
<dt class="field-odd">param CFR_r (list of floats)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type CFR_r (list of floats)<span class="colon">:</span></dt>
<dd class="field-even"><p>CFR rho of interest used to output fluxes</p>
</dd>
<dt class="field-odd">param CFR_r (list of floats)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type CFR_r (list of floats)<span class="colon">:</span></dt>
<dd class="field-even"><p>DFA parameters of interest used to output fluxes</p>
</dd>
<dt class="field-odd">param file_suffix (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type file_suffix (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>the suffix of filenames to read</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>res_df (pandas.DataFrame)</strong></p>
</dd>
<dt class="field-even">rtype<span class="colon">:</span></dt>
<dd class="field-even"><p>reaction fluxes with parameters of interest</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.logVariance_allocation">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">logVariance_allocation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sampleName</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">replace_dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dataType</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Objective'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/daweilin/StemCell/cancer_model.mat'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.logVariance_allocation" title="Permalink to this definition">¶</a></dt>
<dd><section id="id6">
<h3>Parameter<a class="headerlink" href="#id6" title="Permalink to this heading">¶</a></h3>
<p>flux_df (pandas.DataFrame): table of reaction fluxes
obj_df (pandas.DataFrame): table of objective coefficients
sampleName (str): name of the sample which will be used for the prefix of filenames (e.g. scEmbryo)
replace_dict (dictionary): e.g. {‘1Cto2cell’:’sc1C2C’, ‘2Cto32cell’:’sc2CBC’}</p>
<dl class="field-list simple">
<dt class="field-odd">rtype<span class="colon">:</span></dt>
<dd class="field-odd"><p>None</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.lollipop_fig">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">lollipop_fig</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mets_category</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cols</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value_ordering</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save_root_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'./'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.lollipop_fig" title="Permalink to this definition">¶</a></dt>
<dd><p>Visualize metabolic objectives with lollipop plots</p>
<ol class="arabic simple">
<li><p>Visualize proportion of metabolites selected by up to three different samples</p></li>
<li><p>Generates figures</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_df</strong> (<em>{pandas.DataFrame}</em>) – a table with metabolites as rows and cells as columns</p></li>
<li><p><strong>mets_category</strong> (<em>{dictionary}</em>) – a dict of metabolites with corresponding types</p></li>
<li><p><strong>labels</strong> (<em>{list/pandas.DataFrame/numpy.array}</em><em>,</em>) – desired labels for columns</p></li>
<li><p><strong>cols</strong> (<em>{list/numpy.array}</em>) – names of the samples (e.g. control, exp1, exp2)</p></li>
<li><p><strong>prefix</strong> (<em>{str}</em>) – name of the experiment for saving figures</p></li>
<li><p><strong>value_ordering</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – sort values based on fold changes if set true</p></li>
<li><p><strong>cutoff</strong> (<em>{float}</em><em>, </em><em>default=0.1</em>) – the portion of cells selecting a metabolite</p></li>
<li><p><strong>save_root_path</strong> (<em>{str}</em><em>, </em><em>default='./'</em>) – path to save the figure</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>plot_df</strong> – generate a figure and dataframe of calculations</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>{pandas.DataFrame}</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.metObj_gene_essentiality">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">metObj_gene_essentiality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef_paths</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_para</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zscore'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">th</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Recon3D'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">geneID_symbol_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/nfs/turbo/umms-csriram/daweilin/data/BiGG/Recon3D_genes.json'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.metObj_gene_essentiality" title="Permalink to this definition">¶</a></dt>
<dd><section id="id7">
<h3>Description<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h3>
<p>Read coefficients of WT and KO strains and identify essential genes</p>
<dl class="field-list simple">
<dt class="field-odd">param coef_paths (str)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type coef_paths (str)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access the data of coefficients. examples are below</p>
</dd>
<dt class="field-odd">param (example)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param ===<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
<dt class="field-odd">param coef_paths = [<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">param ‘/nfs/turbo/umms-csriram/daweilin/regression_models/GeneKO/flux_sl_ESC_recon3d_paraScan_r10_norm_nonorm.csv’<span class="colon">:</span></dt>
<dd class="field-even"><p></p></dd>
</dl>
<p>:param :
:param ‘/nfs/turbo/umms-csriram/daweilin/regression_models/GeneKO/flux_sl_ESC_recon3d_paraScan_r1_norm_nonorm.csv’: ]
:param : ]
:param ===:
:param sel_para (str):
:type sel_para (str): parameters used for the analysis, e.g. ‘k1_r1’
:param method (str):
:type method (str): the criteria for identifying essential genes. options are ‘zscore’, ‘quantile’, and ‘’ which is nonzero changes
:param th (float):
:type th (float): thresholds of distances from the WT to KO coefficients
:param model_name (str):
:type model_name (str): name of the genome scale metabolic models. options are ‘Recon3D’, ‘Recon2.2’, and ‘’ which is Shen’s Recon1
:param geneID_symbol_path (str):
:type geneID_symbol_path (str): path to access .json files that contains the gene IDs used in the GEMs with corresponding gene symbols</p>
<dl class="field-list simple">
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>growth_genes (list)</strong> (<em>a list of genes that make the distances from the WT to KO coefficients greater than a threshold</em>)</p></li>
<li><p><strong>nongrowth_genes (list)</strong> (<em>return a list of genes that change the coefficients in opposite direction if a reference exists</em>)</p></li>
<li><p><strong>coefs_df (pandas.DataFrame)</strong> (<em>processed coefficients</em>)</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.objective_flux_matching">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">objective_flux_matching</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">metabolome_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sheet_name</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">MetCol</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mets_category</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">manual_map</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zscore_mets</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">{}</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.objective_flux_matching" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>(</strong><strong>str</strong><strong>)</strong> (<em>MetCol</em>) – </p></li>
<li><p><strong>(</strong><strong>str</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>str</strong><strong>)</strong> – </p></li>
<li><p><strong>(</strong><strong>dictionary</strong><strong>)</strong> (<em>mets_category</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>match_map_df (pandas.DataFrame)</em></p></li>
<li><p><em>ffm_cp (pandas.DataFrame)</em></p></li>
<li><p><em>ffm_reg (pandas.DataFrame)</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.overlap_allocation_plot">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">overlap_allocation_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coef_df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">labels</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_col</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">prefix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cutoff</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">special_labels</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.overlap_allocation_plot" title="Permalink to this definition">¶</a></dt>
<dd><p>The allocation of each metabolite in objectives that are shown with overlapped barplots.</p>
<p>The allocation of coefficients will be represented by
c/Sigma(c) if norm is set true</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>coef_df</strong> (<em>{pandas.DataFrame}</em><em> of </em><em>shape</em><em> (</em><em>n_metabolites</em><em>, </em><em>n_samples</em><em>)</em><em>,</em>) – the coefficients of metabolic objectives for each samples</p></li>
<li><p><strong>labels</strong> (<em>{array-like}</em><em> of </em><em>shape</em><em> (</em><em>n_samples</em><em>,</em><em>)</em><em>,</em>) – the labels of samples/columns</p></li>
<li><p><strong>cellType</strong> (<em>{string}</em><em>,</em>) – the label used as a reference</p></li>
<li><p><strong>prefix</strong> (<em>{string}</em><em>, </em><em>default=''</em>) – experiment names for saving files</p></li>
<li><p><strong>norm</strong> (<em>{bool}</em><em>, </em><em>default=True</em>) – normalize coefficients by the sum of all the coefficients</p></li>
<li><p><strong>cutoff</strong> (<em>{float}</em><em>, </em><em>default=0.0</em>) – thresholds to show the allocation/coefficients of metabolites</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>None</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.read_mat_model">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">read_mat_model</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'/home/daweilin/StemCell/cancer_model.mat'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_rxnGeneMat</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">remove_transport</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.read_mat_model" title="Permalink to this definition">¶</a></dt>
<dd><section id="id8">
<h3>Description<a class="headerlink" href="#id8" title="Permalink to this heading">¶</a></h3>
<ol class="arabic simple">
<li><p>read genome-scale metabolic network models (GEMs) from .mat file</p></li>
<li><p>reorganize the model and save into a python dictionary</p></li>
<li><p>(optional) gather subsystems, reacitons, and genes with gpr rules</p></li>
<li><p>(optional) remove transport and exchange reactions for internal reactions analysis</p></li>
</ol>
<dl class="field-list simple">
<dt class="field-odd">param path (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type path (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>the path to access the network model</p>
</dd>
<dt class="field-odd">param return_rxnGeneMat (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p>where columns are genes, additional columns for reactions and subsystems</p>
</dd>
<dt class="field-even">type return_rxnGeneMat (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if output a binary dataframe showing association of GPR rules</p>
</dd>
<dt class="field-odd">param remove_transport (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type remove_transport (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if remove reactions related to exchange/transport subsystems</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_dict (dictionary)</strong> (<em>fields of models and corresponding values, e.g. ‘genes’:[‘A’, ‘B’…]</em>)</p></li>
<li><p><strong>rxnGeneMat (optional, pandas.DataFrame)</strong> (<em>a dataframe with binary values showing association</em>) – between genes and reactions where column names are genes,
additional two columns for reactions and subsystems</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="SCOOTI.regressionAnalyzer.unconstrained_models">
<span class="sig-prename descclassname"><span class="pre">SCOOTI.regressionAnalyzer.</span></span><span class="sig-name descname"><span class="pre">unconstrained_models</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">root_path</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">norm</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">return_variables</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">medium</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'DMEMF12'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">biomass_reaction_name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'biomass_objective'</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#SCOOTI.regressionAnalyzer.unconstrained_models" title="Permalink to this definition">¶</a></dt>
<dd><section id="id9">
<h3>Description<a class="headerlink" href="#id9" title="Permalink to this heading">¶</a></h3>
<p>Unconstrained modeling of fluxes with different objectives</p>
<dl class="field-list simple">
<dt class="field-odd">param root_path (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type root_path (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>path to access all the files</p>
</dd>
<dt class="field-odd">param norm (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type norm (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>if normalize the data or not</p>
</dd>
<dt class="field-odd">param return_variables (bool)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type return_variables (bool)<span class="colon">:</span></dt>
<dd class="field-even"><p>True for return fluxes or False for objective values</p>
</dd>
<dt class="field-odd">param medium (string)<span class="colon">:</span></dt>
<dd class="field-odd"><p></p></dd>
<dt class="field-even">type medium (string)<span class="colon">:</span></dt>
<dd class="field-even"><p>medium used for input metabolites e.g. DMEMF12 or KSOM</p>
</dd>
<dt class="field-odd">returns<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>res_df (optional, pandas.DataFrame)</strong> (<em>reaction fluxes excluding objective values</em>)</p></li>
<li><p><strong>dm_df (optional, pandas.DataFrame)</strong> (<em>fluxes of demand reactions of candidate metabolites</em>)</p></li>
</ul>
</dd>
</dl>
</section>
</dd></dl>

</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">SCOOTI</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Welcome to the documentation of metabolic objective analysis</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-SCOOTI.regressionAnalyzer">Core Analysis Module</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="metObjAnalyzer.html">Welcome to the documentation of metabolic objective analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="scootisettings.html">SCOOTI Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="advancedusage.html">Advanced usage</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to SCOOTI’s documentation!</a></li>
      <li>Next: <a href="metObjAnalyzer.html" title="next chapter">Welcome to the documentation of metabolic objective analysis</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Chandrasekaran Lab, University of Michigan.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/regressionAnalyzer.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>